{"version":3,"sources":["../index.js"],"names":["RAF","window","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","cb","setTimeout","isBody","element","document","body","documentElement","getScrollTop","pageYOffset","undefined","parentNode","scrollTop","scrollToElement","target","topOffset","maxTime","parent","startingTop","getBoundingClientRect","top","distanceToScroll","duration","Math","min","abs","startingTime","Date","doIt","time","ratio","distanceSoFar","scrollTo","getState","el","state","href","currentUrl","dataset","key","hasOwnProperty","navigationId","InternalLinkRouter","handleClick","event","defaultPrevented","metaKey","a","nodeName","backButton","getAttribute","props","goBack","routeInterceptor","shouldContinue","preventDefault","charAt","location","pathname","search","hash","replace","redirect","indexOf","split","scrollToEl","getElementById","substr","children","Component","dispatch","url"],"mappings":"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","file":"index.js","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport { push, replace, goBack } from 'react-router-redux';\n\nimport Scrollparent from 'scrollparent';\n\nimport easeInOut from 'eases/quad-in-out';\n\nconst RAF = (function () {\n    if (typeof window === 'undefined') {\n        return () => {};\n    }\n    return window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || function (cb) { setTimeout(cb, 16); };\n})();\n\nfunction isBody (element) {\n    return element === document.body || element === document.documentElement;\n}\n\nfunction getScrollTop (element) {\n    if (isBody(element)) {\n        return (window.pageYOffset !== undefined)\n                ? window.pageYOffset\n                : (document.documentElement || document.body.parentNode || document.body).scrollTop;\n    } else {\n        return element.scrollTop;\n    }\n}\n\nfunction scrollToElement (target, topOffset, maxTime) {\n    let parent = Scrollparent(target);\n    let startingTop = getScrollTop(parent);\n\n    if (!isBody(parent)) {\n        scrollToElement(parent, topOffset, maxTime);\n        topOffset = parent.getBoundingClientRect().top;\n    }\n\n    let distanceToScroll;\n    if (target) {\n        distanceToScroll = target.getBoundingClientRect().top - (topOffset || 0);\n    } else {\n        distanceToScroll = -startingTop;\n    }\n\n    let duration = Math.min(Math.abs(distanceToScroll) * 2, maxTime);\n    let startingTime = new Date();\n    RAF(function doIt() {\n        let time = new Date() - startingTime;\n        let ratio = easeInOut(Math.min(1, time / duration));\n        let distanceSoFar = distanceToScroll * ratio;\n        if (isBody(parent)) {\n            window.scrollTo(0, distanceSoFar + startingTop);\n        } else {\n            parent.scrollTop = distanceSoFar + startingTop;\n        }\n        if (ratio < 1) {\n            RAF(doIt);\n        }\n    });\n}\n\nfunction getState (el, state={}) {\n    if (el.href) {\n        state.currentUrl = el.href;\n    }\n\n    if (el.dataset) {\n        for (var key in el.dataset) {\n            if (el.dataset.hasOwnProperty(key)) {\n                // for some reason Object.assign doesn't work in Safari.\n                state[key] = el.dataset[key];\n            }\n        }\n    }\n\n    if (el.parentNode && el.parentNode.dataset) {\n        return getState(el.parentNode, state);\n    }\n    return state;\n}\n\n\nvar navigationId = 0;\n\nexport class InternalLinkRouter extends React.Component {\n\n    handleClick = (event) => {\n        if (event.defaultPrevented || event.metaKey) {\n            return;\n        }\n\n        var el = event.target;\n        var a;\n        while (el && el.parentNode) {\n            if (el.nodeName === 'A' || el.dataset && el.dataset.backButton) {\n                a = el;\n                break;\n            }\n            el = el.parentNode;\n        }\n\n        if (!a || a.target || a.getAttribute('download')) {\n            return;\n        }\n\n        if (a.dataset && a.dataset.backButton) {\n            this.props.goBack();\n            return;\n        }\n\n        var href = a.getAttribute('href');\n\n        if (this.props.routeInterceptor) {\n            let shouldContinue = this.props.routeInterceptor(href);\n            if (!shouldContinue) {\n                event.preventDefault();\n                return;\n            }\n        }\n\n        if (href && href.charAt(0) === '/' && href.charAt(1) !== '/') {\n            event.preventDefault();\n            let state =  getState(event.target);\n            state.navigationId = navigationId++;\n            let location = {\n                pathname: a.pathname,\n                search: a.search,\n                hash: a.hash,\n                state\n            };\n\n            if (a.dataset && a.dataset.replace) {\n                this.props.replace(location);\n            } else {\n                this.props.redirect(location);\n            }\n            if (href.indexOf('#') !== -1) {\n                let hash = href.split('#')[1];\n                setTimeout(() => {\n                    let scrollToEl = document.getElementById(hash);\n                    if (scrollToEl) {\n                        scrollToElement(scrollToEl, this.props.topOffset, 0);\n                    }\n                }, 33);\n            } else {\n                window.scrollTo(0, 0);\n            }\n        }\n\n        if (href && href.charAt(0) === '#') {\n            let target = document.getElementById(href.substr(1));\n            if (target || href === '#') {\n                scrollToElement(target, this.props.topOffset, 750);\n            }\n            event.preventDefault();\n        }\n    }\n\n    render () {\n        return (<div onClick={this.handleClick} data-link-router>\n            {this.props.children}\n        </div>);\n    }\n}\n\nexport default connect(null, function (dispatch) {\n    return {\n        redirect: (url) => dispatch(push(url)),\n        replace: (url) => dispatch(replace(url)),\n        goBack: () => dispatch(goBack())\n    };\n})(InternalLinkRouter);\n"]}